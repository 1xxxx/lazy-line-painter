/*
 * Lazy Line Painter
 * SVG Stroke animation.
 *
 * https://github.com/camoconnell/lazy-line-painter
 * http://www.camoconnell.com
 *
 * Copyright © 2013-2015 Cam O'Connell
 * All rights reserved.
 *
 * Licensed under the GNU license.
 *
 */


/*
 *
 * TERMS OF USE - EASING EQUATIONS
 *
 * Open source under the BSD License.
 *
 * Copyright Â© 2001 Robert Penner
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice, this list of
 * conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice, this list
 * of conditions and the following disclaimer in the documentation and/or other materials
 * provided with the distribution.
 *
 * Neither the name of the author nor the names of contributors may be used to endorse
 * or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 *  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 *  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
 * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 *  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */


(function(k){var u={init:function(a){return this.each(function(){var c=k(this),b=c.data("lazyLinePainter");c.addClass("lazylinepainter");if(!b){var b=k.extend({strokeWidth:2,strokeDash:null,strokeColor:"#000",strokeOverColor:null,strokeCap:"round",strokeJoin:"round",strokeOpacity:1,onComplete:null,onUpdate:null,onStart:null,onStrokeStart:null,onStrokeComplete:null,delay:0,ease:null,overrideKey:null,drawSequential:!0,speedMultiplier:1,reverse:!1,paused:!1,progress:0,_longestDuration:0,playhead:0},
a),d=b.overrideKey?b.overrideKey:c.attr("id").replace("#","");b.width=b.svgData[d].dimensions.width;b.height=b.svgData[d].dimensions.height;b.paths=k.extend(!0,[],b.svgData[d].strokepath);var d="0 0 "+b.width+" "+b.height,e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"viewBox",d);e.setAttribute("xmlns","http://www.w3.org/2000/svg");d=k(e);b.svg=d;for(var d=b.delay*b.speedMultiplier,e=b.paths,g=d,h=0;h<e.length;h++)g+=e[h].duration*b.speedMultiplier;e=g;g=b.reverse?
e:0;for(h=0;h<b.paths.length;h++){var f=b.paths[h];f.progress=0;f.index=h;var p=f,l=b,m=h,n=document.createElementNS("http://www.w3.org/2000/svg","path"),r=k(n);l.svg.append(r);r.attr(z(l,l.paths[m]));p.el=n;f.length=Math.ceil(f.el.getTotalLength());f.delay=f.delay||0;f.duration*=b.speedMultiplier;p=f;l=f.el;m=f.length;n=[];for(r=0;r<m;r++){var q=l.getPointAtLength(r);n.push({x:q.x,y:q.y})}p.positions=n;f.ease=f.ease||null;p=f.el.style;l=b;m=f.length;n=void 0;n=f.strokeDash?v(f.strokeDash,m):l.strokeDash?
v(l.strokeDash,m):m+" "+m;p.strokeDasharray=n;f.el.style.strokeDashoffset=f.length;f.el.style.display="block";f.el.getBoundingClientRect();f.onStrokeStart=f.onStrokeStart||null;f.onStrokeComplete=f.onStrokeComplete||null;f.onStrokeStartDone=!1;f.onStrokeCompleteDone=!1;f.onStrokeUpdate=f.onStrokeUpdate||null;f.duration>b._longestDuration&&(b._longestDuration=f.duration);l=f.duration/e;b.reverse?g-=f.duration:b.drawSequential?g=b.playhead+d:(g=f.delay+d,console.log(g));p=g/e;f.startTime=g;f.startProgress=
p;f.durationProgress=l;b.playhead+=f.duration}b.totalDuration=b.drawSequential?b.playhead:b._longestDuration;b.totalDuration+=d;c.append(b.svg);c.data("lazyLinePainter",b);c.lazylinepainter("resize")}})},paint:function(){return this.each(function(){var a=k(this),c=a.data("lazyLinePainter");a.lazylinepainter("erase");c.rAF=requestAnimationFrame(function(a){t(a,c)});if(null!==c.onStart)c.onStart()})},pause:function(){return this.each(function(){var a=k(this).data("lazyLinePainter");a.paused||(a.paused=
!0,cancelAnimationFrame(a.rAF))})},resume:function(){return this.each(function(){var a=k(this).data("lazyLinePainter");a.paused&&(requestAnimationFrame(function(c){A(c,a)}),a.paused=!1)})},erase:function(){return this.each(function(){var a=k(this).data("lazyLinePainter");a.startTime=null;a.elapsedTime=null;cancelAnimationFrame(a.rAF);a.onStrokeCompleteDone=!1;a.paused=!1;for(var c=0;c<a.paths.length;c++){var b=a.paths[c];b.el.style.strokeDashoffset=b.length;b.onStrokeCompleteDone=!1;b.onStrokeStartDone=
!1}})},destroy:function(){return this.each(function(){var a=k(this);a.removeData("lazyLinePainter");a.empty();a.removeClass("lazylinepainter")})},set:function(a){return this.each(function(){var c=k(this).data("lazyLinePainter");c.progress=a;w(c)})},get:function(){return k(this).data("lazyLinePainter")},resize:function(){this.each(function(){var a=k(this),c=a.data("lazyLinePainter");c.offset=a.offset();for(a=0;a<c.paths.length;a++)x(c,c.paths[a])})}},A=function(a,c){c.startTime=a-c.elapsedTime;requestAnimationFrame(function(a){t(a,
c)})},t=function(a,c){c.startTime||(c.startTime=a);if(null!==c.onUpdate)c.onUpdate();c.elapsedTime=a-c.startTime;c.progress=y(c.totalDuration,c.startTime,c.elapsedTime,c.ease);w(c);if(1>c.progress)c.rAF=requestAnimationFrame(function(a){t(a,c)});else if(null!==c.onComplete)c.onComplete()},w=function(a){for(var c=0;c<a.paths.length;c++){var b=a.paths[c],d=void 0;a.progress>b.startProgress&&a.progress<b.startProgress+b.durationProgress?d=(a.progress-b.startProgress)/b.durationProgress:a.progress>=b.startProgress+
b.durationProgress?d=1:a.progress<=b.startProgress&&(d=0);b.progress=y(1,0,d,b.ease);var d=b,e=d.progress*d.length;d.el.style.strokeDashoffset=a.reverse||d.reverse?-d.length+e:d.length-e;x(a,b);d=a;if(1===b.progress)d.onStrokeComplete&&!b.onStrokeCompleteDone&&(d.onStrokeComplete(b),b.onStrokeComplete||(b.onStrokeCompleteDone=!0)),b.onStrokeComplete&&!b.onStrokeCompleteDone&&(b.onStrokeComplete(b),b.onStrokeCompleteDone=!0);else if(1E-5<b.progress&&(d.onStrokeStart&&!b.onStrokeStartDone&&(d.onStrokeStart(b),
b.onStrokeStart||(b.onStrokeStartDone=!0)),b.onStrokeStart&&!b.onStrokeStartDone&&(b.onStrokeStart(b),b.onStrokeStartDone=!0),b.onStrokeUpdate))b.onStrokeUpdate(b)}},y=function(a,c,b,d){var e;0<b&&b<a?e=d?q[d](b,0,1,a):b/a:b>=a?e=1:b<=c&&(e=0);return e},x=function(a,c){var b=Math.round(c.progress*(c.length-1)),b=c.positions[b];c.position={x:a.offset.left+b.x,y:a.offset.top+b.y}},z=function(a,c){return{d:c.path,stroke:c.strokeColor?c.strokeColor:a.strokeColor,"fill-opacity":0,"stroke-opacity":c.strokeOpacity?
c.strokeOpacity:a.strokeOpacity,"stroke-width":c.strokeWidth?c.strokeWidth:a.strokeWidth,"stroke-linecap":c.strokeCap?c.strokeCap:a.strokeCap,"stroke-linejoin":c.strokeJoin?c.strokeJoin:a.strokeJoin}},v=function(a,c){for(var b="",d=a.split(","),e=0,g=d.length-1;0<=g;g--)e+=Number(d[g]);d=Math.floor(c/e);for(g=d-1;0<=g;g--)b+=a+", ";return(b+(c-d*e)+", "+c).split(",").join("px,")+"px"};k.fn.lazylinepainter=function(a){if(u[a])return u[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==
typeof a&&a)console.log("opps - issue finding method");else return u.init.apply(this,arguments)};var q={easeLinear:function(a,c,b,d){return b*a/d+c},easeInQuad:function(a,c,b,d){return b*(a/=d)*a+c},easeOutQuad:function(a,c,b,d){return-b*(a/=d)*(a-2)+c},easeInOutQuad:function(a,c,b,d){return 1>(a/=d/2)?b/2*a*a+c:-b/2*(--a*(a-2)-1)+c},easeInCubic:function(a,c,b,d){return b*(a/=d)*a*a+c},easeOutCubic:function(a,c,b,d){return b*((a=a/d-1)*a*a+1)+c},easeInOutCubic:function(a,c,b,d){return 1>(a/=d/2)?
b/2*a*a*a+c:b/2*((a-=2)*a*a+2)+c},easeInQuart:function(a,c,b,d){return b*(a/=d)*a*a*a+c},easeOutQuart:function(a,c,b,d){return-b*((a=a/d-1)*a*a*a-1)+c},easeInOutQuart:function(a,c,b,d){return 1>(a/=d/2)?b/2*a*a*a*a+c:-b/2*((a-=2)*a*a*a-2)+c},easeInQuint:function(a,c,b,d){return b*(a/=d)*a*a*a*a+c},easeOutQuint:function(a,c,b,d){return b*((a=a/d-1)*a*a*a*a+1)+c},easeInOutQuint:function(a,c,b,d){return 1>(a/=d/2)?b/2*a*a*a*a*a+c:b/2*((a-=2)*a*a*a*a+2)+c},easeInSine:function(a,c,b,d){return-b*Math.cos(a/
d*(Math.PI/2))+b+c},easeOutSine:function(a,c,b,d){return b*Math.sin(a/d*(Math.PI/2))+c},easeInOutSine:function(a,c,b,d){return-b/2*(Math.cos(Math.PI*a/d)-1)+c},easeInExpo:function(a,c,b,d){return 0==a?c:b*Math.pow(2,10*(a/d-1))+c},easeOutExpo:function(a,c,b,d){return a==d?c+b:b*(-Math.pow(2,-10*a/d)+1)+c},easeInOutExpo:function(a,c,b,d){return 0==a?c:a==d?c+b:1>(a/=d/2)?b/2*Math.pow(2,10*(a-1))+c:b/2*(-Math.pow(2,-10*--a)+2)+c},easeInCirc:function(a,c,b,d){return-b*(Math.sqrt(1-(a/=d)*a)-1)+c},easeOutCirc:function(a,
c,b,d){return b*Math.sqrt(1-(a=a/d-1)*a)+c},easeInOutCirc:function(a,c,b,d){return 1>(a/=d/2)?-b/2*(Math.sqrt(1-a*a)-1)+c:b/2*(Math.sqrt(1-(a-=2)*a)+1)+c},easeInElastic:function(a,c,b,d){var e=1.70158,g=0,h=b;if(0==a)return c;if(1==(a/=d))return c+b;g||(g=.3*d);h<Math.abs(b)?(h=b,e=g/4):e=g/(2*Math.PI)*Math.asin(b/h);return-(h*Math.pow(2,10*--a)*Math.sin(2*(a*d-e)*Math.PI/g))+c},easeOutElastic:function(a,c,b,d){var e=1.70158,g=0,h=b;if(0==a)return c;if(1==(a/=d))return c+b;g||(g=.3*d);h<Math.abs(b)?
(h=b,e=g/4):e=g/(2*Math.PI)*Math.asin(b/h);return h*Math.pow(2,-10*a)*Math.sin(2*(a*d-e)*Math.PI/g)+b+c},easeInOutElastic:function(a,c,b,d){var e=1.70158,g=0,h=b;if(0==a)return c;if(2==(a/=d/2))return c+b;g||(g=.3*d*1.5);h<Math.abs(b)?(h=b,e=g/4):e=g/(2*Math.PI)*Math.asin(b/h);return 1>a?-.5*h*Math.pow(2,10*--a)*Math.sin(2*(a*d-e)*Math.PI/g)+c:h*Math.pow(2,-10*--a)*Math.sin(2*(a*d-e)*Math.PI/g)*.5+b+c},easeInBack:function(a,c,b,d,e){void 0==e&&(e=1.70158);return b*(a/=d)*a*((e+1)*a-e)+c},easeOutBack:function(a,
c,b,d,e){void 0==e&&(e=1.70158);return b*((a=a/d-1)*a*((e+1)*a+e)+1)+c},easeInOutBack:function(a,c,b,d,e){void 0==e&&(e=1.70158);return 1>(a/=d/2)?b/2*a*a*(((e*=1.525)+1)*a-e)+c:b/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+c},easeInBounce:function(a,c,b,d){return b-q.easeOutBounce(d-a,0,b,d)+c},easeOutBounce:function(a,c,b,d){return(a/=d)<1/2.75?7.5625*b*a*a+c:a<2/2.75?b*(7.5625*(a-=1.5/2.75)*a+.75)+c:a<2.5/2.75?b*(7.5625*(a-=2.25/2.75)*a+.9375)+c:b*(7.5625*(a-=2.625/2.75)*a+.984375)+c},easeInOutBounce:function(a,
c,b,d){return a<d/2?.5*q.easeInBounce(2*a,0,b,d)+c:.5*q.easeOutBounce(2*a-d,0,b,d)+.5*b+c}}})(jQuery);